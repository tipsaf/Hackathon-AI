# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1jzaCwnHEccHHuvM9yMhRj_-iiBnrCOkj
"""

import pandas as pd
from sklearn.preprocessing import OneHotEncoder
from sklearn.metrics.pairwise import cosine_similarity
import numpy as np

# Charger le dataset
file_path = 'dataset.csv'
dataset = pd.read_csv(file_path)

# Préparer les données
def preprocess_selected_features(data):
    # Sélectionner les colonnes pertinentes
    selected_columns = ['Water needs', 'Light needs', 'Price (eur)']

    # Encodage OneHot pour les colonnes catégoriques
    encoder = OneHotEncoder()
    categorical_encoded = encoder.fit_transform(data[['Water needs', 'Light needs']]).toarray()

    # Normaliser la colonne numérique (Price)
    numeric_features = data[['Price (eur)']].values
    normalized_numeric = (numeric_features - numeric_features.mean()) / numeric_features.std()

    # Concaténer les vecteurs
    features = np.hstack([categorical_encoded, normalized_numeric])
    return features, data['Plant name'].values

# Préparer les données
features, plant_names = preprocess_selected_features(dataset)

# Fonction pour trouver les plantes similaires
def find_similar_plants(plant_name, features, plant_names, top_n=3):
    if plant_name not in plant_names:
        return f"Plant '{plant_name}' not found in the dataset."

    # Trouver l'index de la plante
    plant_idx = np.where(plant_names == plant_name)[0][0]

    # Calculer la similarité cosine
    similarity = cosine_similarity([features[plant_idx]], features)[0]

    # Obtenir les indices des plantes les plus similaires
    similar_indices = similarity.argsort()[-(top_n + 1):-1][::-1]

    # Retourner les noms des plantes similaires
    similar_plants = plant_names[similar_indices]
    return similar_plants

# Exemple : Trouver des plantes similaires à "Aloe Vera"
similar_to_aloe_vera = find_similar_plants("Geranium", features, plant_names)
print("Plantes similaires à 'Geranium' :", similar_to_aloe_vera)